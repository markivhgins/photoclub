<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Rangeen Pixels — Photography Club</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Cormorant+Garamond:ital,wght@0,300;0,400;1,300;1,400&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
:root{
  --black:#060606;--white:#f0ead8;
  --gold:#c9a84c;--gold2:#e8c96a;
  --silver:#888;
  --green:#39ff8f;
  /* Lens smaller so body looks dramatically wider */
  --L:min(28vw,36vh,270px);
  /* Very deep D7500-style grip */
  --grip:clamp(100px,14vw,155px);
  /* Wide left shoulder */
  --lpad:clamp(28px,4vw,55px);
  --film:0px;
  --EL:min(94vw,92vh);
  --frame-h:180px;
}
@media(max-width:600px){
  :root{--L:min(52vw,30vh,200px);--grip:70px;--lpad:16px;--film:0px;--EL:min(96vw,72vh);--frame-h:110px;}
}
html,body{width:100%;height:100%;overflow:hidden;background:var(--black);color:var(--white);font-family:'Cormorant Garamond',serif;cursor:crosshair;}

/* ── GRAIN ── */
body::after{content:'';position:fixed;inset:0;z-index:3;pointer-events:none;opacity:.7;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='.08'/%3E%3C/svg%3E");}

/* ── HORIZONTAL FILM STRIP ── */
.film-bg{
  position:fixed;
  left:0;right:0;
  top:50%;
  transform:translateY(-50%);
  z-index:1; /* visual layer behind camera */
  overflow:hidden;
  height:var(--frame-h);
  background:#050505;
  border-top:3px solid #1a1a1a;
  border-bottom:3px solid #1a1a1a;
  pointer-events:all;
}
/* sprocket holes top and bottom */
.film-bg::before,.film-bg::after{
  content:'';position:absolute;left:0;right:0;height:14px;z-index:5;pointer-events:none;
  background:repeating-linear-gradient(to right,transparent,transparent 18px,rgba(0,0,0,0) 18px,rgba(0,0,0,0) 22px);
}
.film-bg::before{top:4px;}.film-bg::after{bottom:4px;}
.film-strip-track{
  display:flex;
  flex-direction:row;
  flex-wrap:nowrap;
  width:max-content;
  height:100%;
  align-items:stretch;
}
@keyframes filmLeft{from{transform:translateX(0)}to{transform:translateX(calc(-100% / 3))}}
/* Each frame */
.vfr{
  flex-shrink:0;
  width:calc(var(--frame-h) * 1.5);
  height:100%;
  position:relative;
  border-right:2px solid rgba(255,255,255,0.07);
  background:#060606;
  overflow:hidden;
  cursor:pointer;
  transition:filter .18s, box-shadow .18s;
}
.vfr:hover{filter:brightness(1.6);box-shadow:0 0 0 2px rgba(201,168,76,.8) inset, 0 0 30px rgba(201,168,76,.3) inset;cursor:pointer;}
.vfr:active{filter:brightness(2);}
/* sprocket holes left+right of each frame */
.vfr::before,.vfr::after{
  content:'';position:absolute;left:50%;transform:translateX(-50%);
  width:13px;height:9px;border-radius:2px;
  border:1.5px solid rgba(255,255,255,0.18);background:#000;z-index:4;
}
.vfr::before{top:4px;}.vfr::after{bottom:4px;}
.vfr-img{position:absolute;inset:18px 8px;}
.vfr:nth-child(8n+1) .vfr-img{background:radial-gradient(ellipse at 30% 70%,#3a1800,#040200);filter:sepia(1)contrast(1.4)brightness(.6);}
.vfr:nth-child(8n+2) .vfr-img{background:radial-gradient(ellipse at 70% 20%,#0a1530,#000);filter:brightness(.6)contrast(1.5);}
.vfr:nth-child(8n+3) .vfr-img{background:radial-gradient(ellipse at 50% 90%,#1a0800,#010101);filter:sepia(.9)brightness(.55);}
.vfr:nth-child(8n+4) .vfr-img{background:radial-gradient(ellipse at 20% 50%,#181800,#030300);filter:sepia(.7)contrast(1.3);}
.vfr:nth-child(8n+5) .vfr-img{background:radial-gradient(ellipse at 80% 30%,#05051a,#000);filter:brightness(.55)contrast(1.6);}
.vfr:nth-child(8n+6) .vfr-img{background:radial-gradient(ellipse at 55% 60%,#1a0a00,#000);filter:sepia(1)contrast(1.2);}
.vfr:nth-child(8n+7) .vfr-img{background:radial-gradient(ellipse at 40% 40%,#0e140e,#010101);filter:contrast(1.7)brightness(.45);}
.vfr:nth-child(8n+8) .vfr-img{background:radial-gradient(ellipse at 65% 75%,#1c0505,#000);filter:sepia(.8)brightness(.55);}
.vfr-num{
  position:absolute;bottom:16px;left:50%;transform:translateX(-50%);
  font-family:'Space Mono',monospace;font-size:5px;
  color:rgba(255,255,255,.25);letter-spacing:.06em;z-index:3;pointer-events:none;
}
.vfr-label{
  position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
  font-family:'Space Mono',monospace;font-size:clamp(5px,0.6vw,8px);
  letter-spacing:.12em;color:rgba(201,168,76,.22);text-transform:uppercase;
  text-align:center;z-index:3;pointer-events:none;transition:color .2s, text-shadow .2s;white-space:nowrap;
}
.vfr:hover .vfr-label{color:rgba(201,168,76,1);text-shadow:0 0 12px rgba(201,168,76,.8);}
.film-bg:hover .film-strip-track{animation-play-state:paused;}
/* fade edges of film strip */
.film-fade-l,.film-fade-r{
  position:absolute;top:0;bottom:0;width:80px;z-index:6;pointer-events:none;
}
.film-fade-l{left:0;background:linear-gradient(to right,#060606,transparent);}
.film-fade-r{right:0;background:linear-gradient(to left,#060606,transparent);}
/* Film frame info popup */
#film-popup{
  position:fixed;z-index:500;
  background:linear-gradient(148deg,#131313,#0b0b0b);
  border:1px solid rgba(201,168,76,.3);border-radius:3px;
  padding:28px 32px;
  min-width:280px;max-width:360px;
  box-shadow:0 20px 60px rgba(0,0,0,.95);
  opacity:0;pointer-events:none;
  transition:opacity .25s ease, transform .25s ease;
  transform:translateY(8px);
}
#film-popup.show{opacity:1;pointer-events:all;transform:translateY(0);}
#film-popup .fp-tag{font-family:'Space Mono',monospace;font-size:.42rem;letter-spacing:.28em;color:var(--gold);margin-bottom:6px;text-transform:uppercase;}
#film-popup .fp-title{font-family:'Bebas Neue',sans-serif;font-size:clamp(1.4rem,3vw,2rem);letter-spacing:.07em;line-height:1;margin-bottom:12px;}
#film-popup .fp-body{font-family:'Cormorant Garamond',serif;font-size:.95rem;line-height:1.75;color:rgba(240,234,216,.7);}
#film-popup .fp-close{
  position:absolute;top:10px;right:14px;font-family:'Space Mono',monospace;
  font-size:.48rem;letter-spacing:.2em;color:var(--silver);cursor:pointer;
  background:none;border:none;transition:color .2s;
}
#film-popup .fp-close:hover{color:var(--gold);}
#film-popup .fp-footer{
  margin-top:14px;padding-top:10px;border-top:1px solid rgba(255,255,255,.06);
  font-family:'Space Mono',monospace;font-size:.4rem;letter-spacing:.16em;
  color:rgba(255,255,255,.2);
}

/* ── INTRO ── */
#intro{
  position:fixed;inset:0;z-index:200;
  background:var(--black);
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  gap:.8rem;
  transition:opacity .4s ease;
}
#intro.out{opacity:0;pointer-events:none;}
.intro-logo{
  font-family:'Bebas Neue',sans-serif;
  font-size:clamp(3.5rem,11vw,9rem);
  letter-spacing:.38em;
  /* letter-spacing adds space AFTER every char incl. last, pushing text right.
     text-indent compensates by shifting the whole block left by one spacing unit */
  text-indent:.38em;
  opacity:0;
  animation:fadeUp 1.1s cubic-bezier(.16,1,.3,1) .2s forwards;
  text-align:center;
  width:100%;
  line-height:1;
}
.intro-sub{
  font-family:'Space Mono',monospace;
  font-size:clamp(.42rem,.85vw,.65rem);
  letter-spacing:.46em;
  text-indent:.46em;
  color:var(--gold);
  opacity:0;
  animation:fadeUp .9s ease 1.05s forwards;
  text-align:center;
  width:100%;
}
.intro-line{
  width:clamp(40px,8vw,80px);height:1px;
  background:linear-gradient(to right,transparent,var(--gold),transparent);
  opacity:0;
  animation:fadeUp .7s ease 1.35s forwards;
}
@keyframes fadeUp{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}
#flash{position:fixed;inset:0;z-index:300;background:#fff;opacity:0;pointer-events:none;}
#flash.fire{animation:bigFlash .95s ease forwards;}
@keyframes bigFlash{0%{opacity:0}7%{opacity:1}30%{opacity:.9}65%{opacity:.25}100%{opacity:0;visibility:hidden}}

/* ── TICKER ── */
.ticker{position:fixed;bottom:0;left:0;right:0;height:26px;z-index:10;border-top:1px solid #191919;background:var(--black);overflow:hidden;display:flex;align-items:center;}
.ticker-track{display:flex;gap:72px;white-space:nowrap;animation:tickRoll 32s linear infinite;}
@keyframes tickRoll{to{transform:translateX(-50%)}}
.tick{font-family:'Space Mono',monospace;font-size:.43rem;letter-spacing:.24em;color:rgba(255,255,255,.12);text-transform:uppercase;}
.tick b{color:var(--gold);font-weight:400;margin-right:5px;}

/* ── SCENE ── */
#scene{position:fixed;inset:0;z-index:5;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;}
#scene.show{opacity:1;pointer-events:none;transition:opacity .5s ease;}
@media(max-width:600px){#scene{padding-bottom:30px;}}

/* ── CAMERA WRAP ── */
.cam-wrap{position:relative;display:flex;align-items:center;pointer-events:all;}
.cam-col{display:flex;flex-direction:column;align-items:center;position:relative;z-index:2;
  transition:transform .7s cubic-bezier(.4,0,.2,1), opacity .55s ease;}

/* ══════════════════════════════════════════════════════
   CAMERA BODY — Nikon D7500 faithful recreation
   Key D7500 features from reference photo:
   • Very deep rubber grip on right (darker, taller)
   • Flat left shoulder
   • Pentaprism with Nikon branding, centered-left
   • Top info LCD right of pentaprism
   • Mode dial top-left
   • Front command dial near shutter
   • Lens mount ring visible around lens
   • Pebbled texture everywhere
   • D7500 label on front of grip
══════════════════════════════════════════════════════ */
.cam-body{
  --ph:clamp(8px,1.8vw,16px);
  position:relative;display:flex;flex-direction:column;
  width:calc(var(--L) + var(--lpad)*2 + var(--grip));
  max-width:calc(100vw - var(--film)*2 - 8px);
  background:
    linear-gradient(175deg,#242424 0%,#1e1e1e 18%,#1a1a1a 40%,#161616 65%,#111 100%);
  border-radius:8px 2px 2px 6px;
  box-shadow:
    0 0 0 1px #303030,
    0 0 0 2.5px #0a0a0a,
    0 0 0 3px #222,
    0 30px 80px rgba(0,0,0,.99),
    0 8px 30px rgba(0,0,0,.85),
    inset 0 1px 0 rgba(255,255,255,.07),
    inset 0 -1px 0 rgba(0,0,0,.6);
  overflow:visible;
}
/* Leatherette body texture */
.cam-body::before{
  content:'';position:absolute;inset:0;border-radius:inherit;pointer-events:none;z-index:0;
  background:
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='4'%3E%3Crect width='1' height='1' fill='rgba(255,255,255,0.015)'/%3E%3Crect x='2' y='2' width='1' height='1' fill='rgba(255,255,255,0.012)'/%3E%3C/svg%3E"),
    linear-gradient(175deg,rgba(255,255,255,.04) 0%,rgba(255,255,255,.01) 30%,transparent 60%);
  background-size:4px 4px,100% 100%;
}
/* Nikon red accent stripe — runs full width of lens panel */
.cam-body::after{
  content:'';position:absolute;
  top:0;left:clamp(10px,2vw,20px);
  width:calc(var(--L) + var(--lpad) + 8px);height:2.5px;
  background:linear-gradient(to right,transparent 2%,#d01030 8%,#e01535 90%,transparent);
  box-shadow:0 0 14px rgba(210,20,48,.7), 0 0 4px rgba(210,20,48,.5);
  pointer-events:none;z-index:10;
  border-radius:0 0 2px 0;
}

/* Lens mount ring — the chrome ring around where lens meets body */
.cam-lens-mount-ring{
  position:absolute;
  /* positioned relative to lens-section which contains the lens */
  pointer-events:none;z-index:1;
}

/* ── TOP DECK ── */
.cam-top-deck{
  position:relative;display:flex;align-items:flex-end;
  height:54px;flex-shrink:0;z-index:5;
}
@media(max-width:600px){.cam-top-deck{height:38px;}}

/* Pentaprism — D7500: wide, trapezoidal hump, center-left */
.cam-pentaprism{
  position:absolute;
  left:calc(var(--lpad) + var(--L)*.05);
  bottom:0;
  width:calc(var(--L)*.52);
  height:56px;
  background:linear-gradient(180deg,#282828 0%,#202020 35%,#1a1a1a 60%,#161616 100%);
  border-radius:3px 3px 0 0;
  border:1px solid #333;border-bottom:none;
  box-shadow:
    0 -6px 24px rgba(0,0,0,.9),
    inset 0 1px 0 rgba(255,255,255,.07),
    inset 1px 0 0 rgba(255,255,255,.03),
    inset -1px 0 0 rgba(0,0,0,.4);
  clip-path:polygon(0% 100%,3% 0%,97% 0%,100% 100%);
}
/* "Nikon" label on pentaprism */
.cam-pentaprism-logo{
  position:absolute;
  left:calc(var(--lpad) + var(--L)*.05);
  bottom:22px;
  width:calc(var(--L)*.52);
  text-align:center;
  font-family:'Bebas Neue',sans-serif;
  font-size:clamp(.58rem,2.4vw,1rem);
  letter-spacing:.32em;
  color:rgba(255,255,255,.7);
  pointer-events:none;z-index:8;
  text-shadow:0 1px 4px rgba(0,0,0,.95), 0 0 20px rgba(255,255,255,.05);
}
/* "D7500" model number on pentaprism bottom right */
.cam-pentaprism-model{
  position:absolute;
  right:calc(var(--grip) + clamp(4px,1vw,8px));
  bottom:5px;
  font-family:'Space Mono',monospace;
  font-size:clamp(.28rem,1.2vw,.48rem);
  letter-spacing:.14em;
  color:rgba(255,255,255,.28);
  pointer-events:none;z-index:8;
}
/* Viewfinder eyecup */
.cam-pentaprism::after{
  content:'';position:absolute;
  top:10px;left:18%;right:28%;height:20px;
  background:linear-gradient(to bottom,#020202,#080808);
  border-radius:4px 4px 2px 2px;
  border:1.5px solid #404040;
  box-shadow:
    inset 0 4px 16px rgba(0,0,0,1),
    inset 0 0 8px rgba(0,0,0,.9),
    0 1px 0 rgba(255,255,255,.04),
    0 0 12px rgba(0,0,0,.5);
}
/* Diopter dial — small circle right of VF */
.cam-pentaprism::before{
  content:'';position:absolute;
  top:14px;right:22%;
  width:14px;height:14px;border-radius:50%;
  background:conic-gradient(from 0deg,#2e2e2e,#424242,#1c1c1c,#383838,#1a1a1a);
  border:1.5px solid #383838;
  box-shadow:0 2px 6px rgba(0,0,0,.9), inset 0 1px 0 rgba(255,255,255,.05);
}

/* Mode dial — top left, D7500's large textured dial */
.cam-mode-dial{
  position:absolute;
  left:clamp(6px,1.2vw,14px);
  bottom:7px;
  width:48px;height:48px;border-radius:50%;
  background:conic-gradient(from 18deg,
    #222 0deg,#333 22deg,
    #141414 50deg,#2a2a2a 80deg,
    #1a1a1a 108deg,#323232 135deg,
    #111 165deg,#282828 192deg,
    #1c1c1c 220deg,#2e2e2e 248deg,
    #121212 278deg,#252525 308deg,
    #1e1e1e 335deg,#222 360deg
  );
  border:2px solid #3a3a3a;
  box-shadow:
    0 6px 20px rgba(0,0,0,.98),
    0 2px 6px rgba(0,0,0,.8),
    inset 0 1px 0 rgba(255,255,255,.08),
    inset 0 -1px 0 rgba(0,0,0,.7);
  z-index:8;cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  transition:box-shadow .15s,transform .1s;touch-action:manipulation;
}
/* Inner hub of mode dial */
.cam-mode-dial::before{
  content:'';position:absolute;inset:9px;border-radius:50%;
  background:radial-gradient(circle at 38% 32%,#2e2e2e,#111 70%);
  border:1px solid #2c2c2c;
  box-shadow:inset 0 1px 4px rgba(0,0,0,.8);
}
/* Indicator marker at top */
.cam-mode-dial::after{
  content:'';position:absolute;
  width:4px;height:4px;border-radius:50%;
  background:var(--gold);top:4px;left:50%;transform:translateX(-50%);
  box-shadow:0 0 8px var(--gold), 0 0 3px var(--gold);z-index:1;
}
.cam-mode-dial:hover{box-shadow:0 0 20px rgba(201,168,76,.4);}
.cam-mode-dial:active{transform:scale(.92);}
.cam-mode-dial.spin::before{animation:spinA .5s cubic-bezier(.4,0,.2,1);}
@keyframes spinA{to{transform:rotate(360deg)}}
.cam-mode-dial svg{width:14px;height:14px;stroke:rgba(255,255,255,.3);fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;position:relative;z-index:2;}
@media(max-width:600px){.cam-mode-dial{width:32px;height:32px;left:0;bottom:3px;}}

/* Top info LCD */
.cam-top-lcd{
  position:absolute;
  right:calc(var(--grip) + 14px);
  top:4px;
  width:clamp(52px,9.5vw,78px);height:46px;
  background:linear-gradient(160deg,#010e05,#011008);
  border:1px solid #162414;
  border-radius:3px;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  box-shadow:
    0 0 16px rgba(57,255,143,.08),
    0 0 4px rgba(57,255,143,.04),
    inset 0 2px 8px rgba(0,0,0,.98),
    inset 0 0 12px rgba(57,255,143,.03);
  overflow:hidden;z-index:6;
}
.cam-top-lcd::before{content:'';position:absolute;inset:0;
  background:repeating-linear-gradient(to bottom,transparent,transparent 2px,rgba(0,0,0,.18) 2px,rgba(0,0,0,.18) 3px);}
.cam-top-lcd-text{
  font-family:'Space Mono',monospace;
  font-size:clamp(5px,1.1vw,7px);
  color:rgba(57,255,143,.85);
  letter-spacing:.04em;text-align:center;line-height:1.9;
  z-index:1;pointer-events:none;
  text-shadow:0 0 6px rgba(57,255,143,.5);
}

/* Right deck — shutter button platform */
.cam-deck-right{
  position:absolute;right:0;bottom:0;
  width:calc(var(--grip) + 8px);height:44px;
  background:linear-gradient(to bottom,#1e1e1e,#161616);
  border-radius:5px 5px 0 0;
  border:1px solid #2e2e2e;border-bottom:none;
  display:flex;align-items:center;justify-content:center;
  gap:8px;padding:0 8px;
  box-shadow:inset 0 1px 0 rgba(255,255,255,.04), 0 -2px 8px rgba(0,0,0,.4);
}
@media(max-width:600px){.cam-deck-right{height:30px;}}

/* Shutter button — D7500: raised oval, metallic with red thread */
.shutter-btn{
  width:24px;height:19px;
  border-radius:50% 50% 44% 44%;
  background:linear-gradient(170deg,#7a7a7a 0%,#606060 30%,#484848 65%,#303030 100%);
  border:1px solid #777;
  cursor:pointer;position:relative;
  box-shadow:
    0 4px 14px rgba(0,0,0,.95),
    0 2px 4px rgba(0,0,0,.7),
    inset 0 1px 0 rgba(255,255,255,.28),
    inset 0 -1px 0 rgba(0,0,0,.4);
  transition:transform .08s,background .2s,box-shadow .2s;
  flex-shrink:0;touch-action:manipulation;
}
/* Red thread on shutter */
.shutter-btn::before{
  content:'';position:absolute;
  top:3px;left:50%;transform:translateX(-50%);
  width:8px;height:2px;border-radius:1px;
  background:rgba(210,20,46,.9);
  box-shadow:0 0 6px rgba(210,20,46,.5);
}
.shutter-btn::after{
  content:'';position:absolute;top:5px;left:16%;right:16%;
  height:4px;border-radius:50%;
  background:rgba(255,255,255,.14);
}
.shutter-btn:hover,.shutter-btn.active-btn{
  background:linear-gradient(to bottom,#1a3240,#0e1e28);
  border-color:rgba(201,168,76,.6);box-shadow:0 0 14px rgba(201,168,76,.5);
}
.shutter-btn:active{transform:translateY(2px);}

/* Front command dial — small wheel near shutter */
.cam-rear-dial{
  width:16px;height:16px;border-radius:3px;
  background:conic-gradient(from 0deg,#2a2a2a,#181818,#303030,#181818);
  border:1px solid #2c2c2c;
  box-shadow:0 2px 6px rgba(0,0,0,.85);
  cursor:pointer;flex-shrink:0;
  transition:box-shadow .15s;
}
.cam-rear-dial:hover{box-shadow:0 0 8px rgba(201,168,76,.25);}

.led{width:5px;height:5px;border-radius:50%;background:#c0392b;flex-shrink:0;box-shadow:0 0 7px #c0392b;animation:ledBlink 2.8s ease-in-out infinite;}
@keyframes ledBlink{0%,100%{opacity:1}45%{opacity:.1}}

/* ── MAIN BODY ── */
.cam-main{position:relative;display:flex;align-items:stretch;flex:1;}
.cam-lens-section{
  flex:1;
  padding:clamp(4px,.9vh,9px) calc(var(--lpad) - 10px);
  display:flex;
  flex-direction:column;
  align-items:center;
  position:relative;
}
/* Subtle front body panel separation — chrome-like divider line */
.cam-lens-section::before{
  content:'';position:absolute;
  top:0;bottom:0;left:0;right:0;
  border-right:1px solid #252525;
  box-shadow:1px 0 0 rgba(0,0,0,.5);
  pointer-events:none;
}
.cam-brand-label{
  width:100%;
  display:flex;
  align-items:baseline;
  justify-content:space-between;
  margin-bottom:clamp(2px,.5vh,5px);
  padding-left:6px; /* nudges text left a bit */
}
.cam-brand{
  font-family:'Bebas Neue',sans-serif;
  font-size:clamp(.75rem,3.8vw,1.15rem);
  letter-spacing:.3em;
  color:var(--gold);
  text-shadow:0 0 20px rgba(201,168,76,.35), 0 1px 2px rgba(0,0,0,.8);
}
.cam-spec{font-family:'Space Mono',monospace;font-size:clamp(.22rem,1.4vw,.34rem);color:var(--silver);letter-spacing:.13em;opacity:.38;}

/* ── GRIP — D7500: deep rubber-clad forward grip ── */
.cam-grip{
  width:var(--grip);flex-shrink:0;
  background:linear-gradient(to right,
    #0a0a0a 0%,
    #0e0e0e 18%,
    #0b0b0b 50%,
    #070707 80%,
    #050505 100%);
  border-radius:0 16px 14px 0;
  border-left:1px solid #1a1a1a;
  position:relative;overflow:hidden;
  box-shadow:
    inset -8px 0 22px rgba(0,0,0,.95),
    8px 0 28px rgba(0,0,0,.75),
    inset 2px 0 0 rgba(255,255,255,.015),
    inset 0 0 40px rgba(0,0,0,.5);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  gap:10px;padding:62px 0 24px;
}
/* Raised dot rubber texture — Nikon signature */
.cam-grip::before{
  content:'';position:absolute;inset:0;
  background:
    radial-gradient(circle at 2px 2px,rgba(255,255,255,.028) 1.4px,transparent 1.4px),
    linear-gradient(to right,rgba(0,0,0,.35),rgba(0,0,0,.08) 35%,rgba(0,0,0,.25));
  background-size:5px 5px,100% 100%;
}
/* Right edge gloss curve highlight */
.cam-grip::after{
  content:'';position:absolute;top:8%;bottom:8%;right:3px;width:4px;
  background:linear-gradient(to bottom,transparent 5%,rgba(255,255,255,.055) 25%,rgba(255,255,255,.055) 75%,transparent 95%);
  border-radius:3px;
}


/* Small top LCD on grip showing ISO */
.cam-lcd{
  position:absolute;top:14px;left:50%;transform:translateX(-50%);
  width:calc(var(--grip) - 22px);height:30px;
  background:#010d04;border:1px solid #142010;border-radius:2px;
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 0 10px rgba(57,255,143,.06),inset 0 2px 5px rgba(0,0,0,.95);
  overflow:hidden;z-index:2;
}
.cam-lcd::before{content:'';position:absolute;inset:0;
  background:repeating-linear-gradient(to bottom,transparent,transparent 2px,rgba(0,0,0,.14) 2px,rgba(0,0,0,.14) 3px);}
.cam-lcd-text{font-family:'Space Mono',monospace;font-size:6px;color:rgba(57,255,143,.78);letter-spacing:.04em;text-align:center;line-height:1.65;z-index:1;}

/* Knobs on grip */
.knob{
  width:26px;height:26px;border-radius:50%;z-index:1;flex-shrink:0;
  background:conic-gradient(from 15deg,#2c2c2c,#161616,#383838,#141414,#2c2c2c);
  border:1px solid #282828;
  box-shadow:0 3px 10px rgba(0,0,0,.92),inset 0 1px 0 rgba(255,255,255,.04);
  cursor:pointer;display:flex;align-items:center;justify-content:center;
  transition:box-shadow .15s,transform .08s;touch-action:manipulation;
}
.knob:hover{box-shadow:0 0 14px rgba(201,168,76,.35);}
.knob:active{transform:scale(.86);}
.knob svg{width:10px;height:10px;stroke:rgba(255,255,255,.3);fill:none;stroke-width:2.5;stroke-linecap:round;stroke-linejoin:round;}
.knob.flash{animation:kFlash .25s ease;}
@keyframes kFlash{50%{box-shadow:0 0 20px rgba(201,168,76,.85);}}
@media(max-width:600px){.knob{width:30px;height:30px;}}

/* D7500 model label on grip front */
.cam-grip-label{
  font-family:'Space Mono',monospace;
  font-size:clamp(4.5px,.9vw,7px);
  letter-spacing:.16em;
  color:rgba(255,255,255,.18);
  text-transform:uppercase;
  z-index:1;
  transform:rotate(90deg);
  white-space:nowrap;
  pointer-events:none;
}

/* ── BOTTOM BAR ── */
.cam-bottom{
  display:flex;align-items:center;justify-content:space-between;
  padding:clamp(4px,.7vh,9px) var(--lpad);
  padding-right:calc(var(--lpad) + var(--grip));
  border-top:1px solid #202020;
  background:linear-gradient(to bottom,#141414,#0d0d0d);
  border-radius:0 0 2px 6px;
  position:relative;
  box-shadow:inset 0 1px 0 rgba(255,255,255,.04);
}
/* Port door */
.cam-bottom::after{
  content:'';position:absolute;
  left:calc(var(--lpad) + var(--L)*.5);bottom:5px;
  width:26px;height:10px;border-radius:2px;
  border:1px solid #222;
  background:linear-gradient(to bottom,#0f0f0f,#090909);
  box-shadow:inset 0 1px 3px rgba(0,0,0,.7);
}
.cam-rd{font-family:'Space Mono',monospace;font-size:clamp(.24rem,1.5vw,.38rem);letter-spacing:.13em;opacity:.4;}
.cam-rd.g{color:var(--gold);}.cam-rd.s{color:var(--silver);}
.cam-ap{font-family:'Cormorant Garamond',serif;font-style:italic;font-size:clamp(.32rem,1.8vw,.52rem);opacity:.18;}

/* lens assembly — overflow visible so icons can orbit outside rings */
.lens-asm{position:relative;width:var(--L);height:var(--L);flex-shrink:0;overflow:visible;}

/* rings — Nikon AF-S Nikkor style multi-ring barrel */
.ring{position:absolute;border-radius:50%;}
/* Outer bezel ring — full diameter, chrome-edged */
.r-outer{
  inset:0;
  background:conic-gradient(from 0deg,
    #222,#383838,#111,#323232,
    #1a1a1a,#404040,#0f0f0f,#2e2e2e,
    #1c1c1c,#363636,#101010,#222);
  box-shadow:
    0 0 0 2px #050505,
    0 0 0 4px #1c1c1c,
    0 0 0 5px #080808,
    0 20px 60px rgba(0,0,0,.98),
    inset 0 0 30px rgba(0,0,0,.6);
  animation:spinFwd 32s linear infinite;
}
/* Middle focusing ring — textured */
.r-mid{
  inset:8%;
  background:conic-gradient(from 80deg,
    #424242,#161616,#505050,#141414,
    #3e3e3e,#111,#464646,#141414);
  animation:spinRev 20s linear infinite;
  box-shadow:inset 0 0 24px rgba(0,0,0,.85),0 0 0 1px #060606;
}
/* Inner mount ring — chrome bayonet effect */
.r-inner{
  inset:17%;
  background:
    radial-gradient(circle at 42% 38%,#2a2a2a,#0e0e0e 65%),
    conic-gradient(from 45deg,#1a1a1a,#2c2c2c,#111,#2a2a2a,#1a1a1a);
  box-shadow:
    inset 0 0 50px rgba(0,0,0,.98),
    inset 0 2px 4px rgba(255,255,255,.04),
    0 0 0 1px #080808;
}
@keyframes spinFwd{to{transform:rotate(360deg)}}
@keyframes spinRev{to{transform:rotate(-360deg)}}

/* iris Rangeen Pixels — inset 25% from lens edge */
.iris{position:absolute;inset:25%;border-radius:50%;overflow:hidden;}
.glass{position:absolute;inset:0;border-radius:50%;overflow:hidden;background:radial-gradient(circle at 38% 32%,rgba(55,95,175,.2),rgba(0,0,0,.97) 62%);transition:background 1.1s;}
.glass.open{background:radial-gradient(circle at 38% 32%,rgba(45,85,155,.1),rgba(0,4,22,.8) 62%);}
.blades{position:absolute;inset:0;border-radius:50%;}
.blade{position:absolute;width:52%;height:52%;background:#050505;transform-origin:bottom right;border-radius:100% 0 0 0;transition:transform .9s cubic-bezier(.4,0,.2,1);}
.blade:nth-child(1){top:0;left:0;transform:rotate(0deg)} .blade:nth-child(2){top:0;left:0;transform:rotate(45deg)}
.blade:nth-child(3){top:0;left:0;transform:rotate(90deg)} .blade:nth-child(4){top:0;left:0;transform:rotate(135deg)}
.blade:nth-child(5){top:0;left:0;transform:rotate(180deg)} .blade:nth-child(6){top:0;left:0;transform:rotate(225deg)}
.blade:nth-child(7){top:0;left:0;transform:rotate(270deg)} .blade:nth-child(8){top:0;left:0;transform:rotate(315deg)}
.blades.open{opacity:0;transition:opacity .65s ease .2s;}

/* lens interior */
.lens-int{position:absolute;inset:0;border-radius:50%;overflow:hidden;opacity:0;transition:opacity .55s;}
.lens-int.visible{opacity:1;}
.lens-bg{position:absolute;inset:0;border-radius:50%;background:radial-gradient(ellipse at 38% 30%,rgba(16,34,76,.6),transparent 52%),radial-gradient(circle,#060811,#000 100%);}
.flare{position:absolute;border-radius:50%;pointer-events:none;}
.fl1{width:38%;height:38%;top:3%;left:4%;background:radial-gradient(circle,rgba(150,195,255,.13),transparent 68%);}
.fl2{width:20%;height:20%;bottom:16%;right:13%;background:radial-gradient(circle,rgba(201,168,76,.16),transparent 68%);}
.fl3{position:absolute;width:55%;height:1px;top:22%;left:18%;background:linear-gradient(to right,transparent,rgba(255,255,255,.06),transparent);transform:rotate(-13deg);}
.fl4{position:absolute;width:28%;height:1px;top:34%;left:52%;background:linear-gradient(to right,transparent,rgba(201,168,76,.09),transparent);transform:rotate(20deg);}
.dust{position:absolute;inset:0;border-radius:50%;pointer-events:none;}
.dust::before{content:'';position:absolute;width:2px;height:2px;border-radius:50%;background:rgba(255,255,255,.5);top:28%;left:62%;
  box-shadow:14px -9px 0 1px rgba(255,255,255,.2),-22px 18px 0 1px rgba(201,168,76,.3),30px 11px 0 1px rgba(255,255,255,.12),-8px -22px 0 1px rgba(255,255,255,.16);}
.hud{position:absolute;inset:0;border-radius:50%;pointer-events:none;z-index:4;}
.hud-h{position:absolute;left:7%;right:7%;top:50%;height:1px;background:linear-gradient(to right,transparent,rgba(255,255,255,.024),transparent);}
.hud-v{position:absolute;top:7%;bottom:7%;left:50%;width:1px;background:linear-gradient(to bottom,transparent,rgba(255,255,255,.024),transparent);}
.hud-c{position:absolute;width:11%;height:11%;border-color:rgba(201,168,76,.13);border-style:solid;}
.hud-c.tl{top:9%;left:9%;border-width:1px 0 0 1px}.hud-c.tr{top:9%;right:9%;border-width:1px 1px 0 0}
.hud-c.bl{bottom:9%;left:9%;border-width:0 0 1px 1px}.hud-c.br{bottom:9%;right:9%;border-width:0 1px 1px 0}
#lens-flash{position:absolute;inset:25%;border-radius:50%;background:#fff;opacity:0;pointer-events:none;z-index:10;}
#lens-flash.blink{animation:lFlash .38s ease forwards;}
@keyframes lFlash{0%{opacity:0}15%{opacity:.8}100%{opacity:0}}
.lens-glow{position:absolute;inset:-12%;border-radius:50%;pointer-events:none;background:radial-gradient(circle,rgba(201,168,76,.07),transparent 65%);animation:gPulse 5s ease-in-out infinite;}
@keyframes gPulse{0%,100%{opacity:.4;transform:scale(1)}50%{opacity:1;transform:scale(1.07)}}

/* Prevent click-through bugs */
#lens-vignette,
#lens-portal,
.panel-ov,
#flash,
#intro {
  pointer-events: none;
}

#lens-vignette.show,
#lens-portal.is-expanded,
.panel-ov.active,
#lens-close.show {
  pointer-events: all;
}
/* ── RADIAL NAV ── */
.nav-radial{position:absolute;inset:0;z-index:30;pointer-events:none;}
.orbit-ring{
  position:absolute;border-radius:50%;
  border:1px solid rgba(57,255,143,.12);
  pointer-events:none;
  opacity:0;
  transition:opacity .5s ease;
}

.nav-item{
  position:absolute;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  border-radius:50%;
  border:1px solid rgba(255,255,255,.09);
  background:rgba(4,12,6,.8);
  backdrop-filter:blur(6px);
  text-decoration:none;color:var(--white);
  cursor:pointer;outline:none;
  -webkit-tap-highlight-color:transparent;
  /* Start invisible — buildNav controls position/size, show class controls opacity */
  opacity:0;transform:scale(.2);pointer-events:none;
  transition:
    opacity .35s ease,
    transform .4s cubic-bezier(.34,1.56,.64,1),
    background .22s,
    border-color .22s,
    box-shadow .22s;
  /* Don't transition left/top/width/height — buildNav sets them instantly */
}

/* Show state: lens expanded + .show class — !important beats any inline opacity */
.lens-expanded .nav-item.show{
  opacity:1!important;
  transform:scale(1)!important;
  pointer-events:all!important;
}

/* CENTER button — visible only when collapsed */
.nav-item.center{
  background:rgba(201,168,76,.08);
  border-color:rgba(201,168,76,.24);
  animation:cGlow 3.5s ease-in-out infinite;
  /* collapsed: opacity/pointer handled by buildNav inline style */
}
@keyframes cGlow{0%,100%{box-shadow:0 0 10px rgba(201,168,76,.1)}50%{box-shadow:0 0 28px rgba(201,168,76,.3)}}
.nav-item.center:hover{animation:none;background:rgba(201,168,76,.2);box-shadow:0 0 20px rgba(201,168,76,.4);}

/* EXPANDED: center MUST be invisible — pip-boy owns the center */
.lens-expanded .nav-item.center{
  opacity:0!important;
  pointer-events:none!important;
  animation:none!important;
}

/* Hover / selected states */
.nav-item:hover{
  background:rgba(57,255,143,.16)!important;
  border-color:rgba(57,255,143,.72)!important;
  transform:scale(1.18)!important;
  box-shadow:0 0 26px rgba(57,255,143,.5),0 0 64px rgba(57,255,143,.12)!important;
  z-index:50;
}
.nav-item:hover .ico{filter:drop-shadow(0 0 6px rgba(57,255,143,.9)) brightness(1.4);}
.nav-item:hover .nav-lbl{opacity:1;color:var(--green);}
.nav-item:active{transform:scale(.85)!important;transition:transform .07s ease!important;}
.nav-item.selected{
  background:rgba(57,255,143,.16)!important;
  border-color:rgba(57,255,143,.88)!important;
  box-shadow:0 0 28px rgba(57,255,143,.55),0 0 64px rgba(57,255,143,.16)!important;
  transform:scale(1.12)!important;
}
.nav-item.selected .nav-lbl{opacity:1;color:var(--green);}

.ico{
  display:flex;align-items:center;justify-content:center;
  width:44%;height:44%;
  transition:filter .22s;pointer-events:none;opacity:.78;
}
.ico svg{width:100%;height:100%;display:block;}
.nav-item:hover .ico,.nav-item.selected .ico{opacity:1;}

/* Icon label */
.nav-lbl{
  font-family:'Space Mono',monospace;
  font-size:clamp(.15rem,.5vw,.24rem);
  letter-spacing:.12em;
  color:rgba(57,255,143,.38);
  text-transform:uppercase;
  margin-top:2px;
  pointer-events:none;
  opacity:.75;
  transition:opacity .2s,color .2s;
  white-space:nowrap;
  line-height:1;
}

/* Collapsed: hide ring items, let center buildNav inline style control */
.lens-asm:not(.lens-expanded) .nav-item:not(.center){
  opacity:0!important;pointer-events:none!important;
}
.lens-asm:not(.lens-expanded) #circ-info{opacity:0!important;pointer-events:none!important;}
.lens-asm:not(.lens-expanded) .orbit-ring{opacity:0!important;}

/* iris deco rings */
.iris-deco{position:absolute;inset:25%;width:50%;height:50%;pointer-events:none;z-index:5;opacity:.18;}

/* ── HINT ── */
.hint{font-family:'Space Mono',monospace;font-size:clamp(.26rem,.44vw,.38rem);letter-spacing:.22em;color:rgba(255,255,255,.1);text-align:center;margin-top:clamp(4px,.7vh,8px);animation:hP 3s ease-in-out .5s infinite;}
@keyframes hP{0%,100%{opacity:.1}50%{opacity:.3}}
@media(max-width:600px){.hint{display:none;}}

/* ══════════════════════════════════════════════════════
   FULLSCREEN LENS PORTAL
   A fixed container that the .lens-asm gets moved into.
   It animates from the camera's position to fill screen.
══════════════════════════════════════════════════════ */
#lens-portal{
  position:fixed;
  /* starts at camera center — JS sets exact px before expanding */
  z-index:50;
  pointer-events:none;
  /* transition only the size/position, not display */
  transition:
    width  .85s cubic-bezier(.16,1,.3,1),
    height .85s cubic-bezier(.16,1,.3,1),
    top    .85s cubic-bezier(.16,1,.3,1),
    left   .85s cubic-bezier(.16,1,.3,1);
}
#lens-portal.is-expanded{pointer-events:all;}
#lens-portal .lens-asm{
  position:absolute;inset:0;
  width:100%!important;height:100%!important;
}

/* dim vignette that appears behind the expanded lens */
#lens-vignette{
  position:fixed;inset:0;z-index:48;
  background:#060606;
  opacity:0;pointer-events:none;
  transition:opacity .6s ease;
}
#lens-vignette.show{opacity:1;}

/* close pill */
#lens-close{
  position:fixed;top:clamp(10px,2vh,18px);left:50%;transform:translateX(-50%);
  z-index:60;font-family:'Space Mono',monospace;font-size:.46rem;letter-spacing:.32em;
  color:rgba(255,255,255,.42);background:rgba(4,4,4,.85);backdrop-filter:blur(10px);
  border:1px solid rgba(255,255,255,.1);border-radius:20px;padding:6px 20px;cursor:pointer;
  opacity:0;pointer-events:none;transition:opacity .3s ease .55s,color .2s,border-color .2s;
  touch-action:manipulation;
}
#lens-close.show{opacity:1;pointer-events:all;}
#lens-close:hover{color:var(--gold);border-color:rgba(201,168,76,.4);}

/* ══════════════════════════════════════════════════════
   PIP-BOY CIRCULAR INFO DISPLAY
   Fallout-inspired green phosphor terminal HUD
   Hidden in normal state, shown when lens is expanded
══════════════════════════════════════════════════════ */
#circ-info{
  position:absolute;inset:0;border-radius:50%;z-index:20;
  display:flex;align-items:center;justify-content:center;
  opacity:0;pointer-events:none;
  transition:opacity .5s ease .15s;
}
#circ-info.show{opacity:1;pointer-events:all;}

/* Deep dark phosphor base */
.ci-glass{
  position:absolute;inset:0;border-radius:50%;
  background:radial-gradient(ellipse 85% 85% at 50% 45%,
    rgba(2,16,8,.96),
    rgba(0,5,2,.99) 80%);
}
/* CRT scan lines */
.ci-scanlines{
  position:absolute;inset:0;border-radius:50%;pointer-events:none;z-index:1;
  background:repeating-linear-gradient(to bottom,
    transparent,transparent 2px,
    rgba(0,0,0,.12) 2px,rgba(0,0,0,.12) 3px);
}
/* Screen curvature vignette */
.ci-vignette{
  position:absolute;inset:0;border-radius:50%;pointer-events:none;z-index:2;
  background:radial-gradient(circle,transparent 38%, rgba(0,8,4,.6) 75%,rgba(0,0,0,.85) 100%);
}
/* Phosphor glow halo */
.ci-phosphor-glow{
  position:absolute;inset:-8px;border-radius:50%;pointer-events:none;z-index:0;
  background:radial-gradient(circle,rgba(57,255,143,.04),transparent 70%);
  animation:pGlow 4s ease-in-out infinite;
}
@keyframes pGlow{0%,100%{opacity:.5}50%{opacity:1}}

/* Rotating gold arc ring */
.ci-arc-wrap{
  position:absolute;inset:-2px;border-radius:50%;pointer-events:none;z-index:3;
  animation:arcSpin 20s linear infinite;
}
@keyframes arcSpin{to{transform:rotate(360deg)}}
.ci-arc-wrap svg{width:100%;height:100%;}
.ci-arc-track{fill:none;stroke:rgba(57,255,143,.08);stroke-width:1.5;}
.ci-arc-fill{fill:none;stroke:var(--green);stroke-width:1.8;stroke-linecap:round;
  stroke-dasharray:301.6;stroke-dashoffset:301.6;
  transition:stroke-dashoffset 1.2s cubic-bezier(.4,0,.2,1);
  filter:drop-shadow(0 0 3px rgba(57,255,143,.8));}

/* Tick marks ring */
.ci-ticks{position:absolute;inset:-10px;border-radius:50%;pointer-events:none;z-index:3;}
.ci-ticks svg{width:100%;height:100%;}

/* Inner content area */
.ci-content{
  position:relative;z-index:10;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  width:68%;text-align:center;
  gap:clamp(2px,.5vh,6px);
}

/* Idle crosshair / pip-boy crosshair */
.ci-idle{display:flex;flex-direction:column;align-items:center;gap:12px;transition:opacity .3s;}
.ci-idle.gone{opacity:0;pointer-events:none;position:absolute;}
.ci-ch-wrap{position:relative;width:52px;height:52px;}
.ci-ch{position:absolute;inset:0;}
.ci-ch::before,.ci-ch::after{content:'';position:absolute;background:rgba(57,255,143,.3);border-radius:1px;}
.ci-ch::before{width:1px;height:100%;left:50%;transform:translateX(-50%);}
.ci-ch::after{height:1px;width:100%;top:50%;transform:translateY(-50%);}
/* Corner ticks on crosshair */
.ci-ch-wrap::before,.ci-ch-wrap::after{content:'';position:absolute;width:10px;height:10px;border-color:rgba(57,255,143,.45);border-style:solid;}
.ci-ch-wrap::before{top:4px;left:4px;border-width:1.5px 0 0 1.5px;}
.ci-ch-wrap::after{bottom:4px;right:4px;border-width:0 1.5px 1.5px 0;}
.ci-ring-pulse{position:absolute;inset:0;border-radius:50%;border:1px solid rgba(57,255,143,.2);animation:rPulse 2.4s ease-in-out infinite;}
@keyframes rPulse{0%,100%{transform:scale(.5);opacity:.5}50%{transform:scale(1.4);opacity:0}}
.ci-idle-lbl{
  font-family:'Space Mono',monospace;
  font-size:clamp(.24rem,.95vw,.36rem);
  letter-spacing:.38em;
  color:rgba(57,255,143,.28);
  text-transform:uppercase;line-height:1.7;
}

/* Active pip-boy card */
.ci-card{display:flex;flex-direction:column;align-items:center;gap:clamp(2px,.45vh,5px);transition:opacity .3s;}
.ci-card.gone{opacity:0;pointer-events:none;position:absolute;}

.ci-eyebrow{
  font-family:'Space Mono',monospace;
  font-size:clamp(.2rem,.8vw,.3rem);
  letter-spacing:.44em;
  color:rgba(57,255,143,.4);
  text-transform:uppercase;
}
.ci-icon-ring{
  width:clamp(34px,5vw,58px);height:clamp(34px,5vw,58px);
  border-radius:50%;
  border:1px solid rgba(57,255,143,.3);
  background:rgba(57,255,143,.04);
  display:flex;align-items:center;justify-content:center;
  position:relative;
  box-shadow:0 0 12px rgba(57,255,143,.15),inset 0 0 10px rgba(0,0,0,.6);
}
.ci-icon-ring::before{content:'';position:absolute;inset:-4px;border-radius:50%;border:1px solid rgba(57,255,143,.1);}
.ci-icon-ring::after{content:'';position:absolute;inset:-8px;border-radius:50%;border:1px dashed rgba(57,255,143,.06);animation:arcSpin 8s linear infinite;}
.ci-icon-ring svg{width:40%;height:40%;stroke:var(--green);fill:none;stroke-width:1.5;stroke-linecap:round;stroke-linejoin:round;filter:drop-shadow(0 0 4px rgba(57,255,143,.7));}

.ci-name{
  font-family:'Bebas Neue',sans-serif;
  font-size:clamp(1.1rem,4vw,2.6rem);
  letter-spacing:.08em;
  color:var(--green);
  text-shadow:0 0 20px rgba(57,255,143,.6),0 0 40px rgba(57,255,143,.2);
  line-height:1;
}
/* Phosphor flicker on name */
.ci-name.flicker{animation:phFlicker .4s ease;}
@keyframes phFlicker{0%,100%{opacity:1}20%{opacity:.7}40%{opacity:1}60%{opacity:.8}80%{opacity:1}}

.ci-desc{
  font-family:'Cormorant Garamond',serif;font-style:italic;
  font-size:clamp(.44rem,1.5vw,.72rem);
  color:rgba(57,255,143,.42);
  line-height:1.45;max-width:90%;
}
.ci-stats{display:flex;gap:clamp(8px,2vw,18px);margin-top:3px;}
.ci-stat{text-align:center;}
.ci-stat .v{
  font-family:'Space Mono',monospace;
  font-size:clamp(.36rem,1.4vw,.62rem);
  color:var(--green);
  text-shadow:0 0 8px rgba(57,255,143,.5);
}
.ci-stat .k{
  font-family:'Space Mono',monospace;
  font-size:clamp(.18rem,.6vw,.24rem);
  letter-spacing:.2em;
  color:rgba(57,255,143,.28);
  text-transform:uppercase;margin-top:1px;
}
/* Divider line between stats */
.ci-stat-divider{width:1px;background:rgba(57,255,143,.12);align-self:stretch;margin:2px 0;}

.ci-open-btn{
  font-family:'Space Mono',monospace;
  font-size:clamp(.22rem,.8vw,.3rem);
  letter-spacing:.32em;
  color:rgba(57,255,143,.6);
  background:rgba(57,255,143,.04);
  border:1px solid rgba(57,255,143,.22);
  border-radius:1px;
  padding:clamp(3px,.45vh,5px) clamp(8px,1.4vw,14px);
  cursor:pointer;margin-top:4px;
  transition:background .2s,color .2s,border-color .2s,box-shadow .2s;
  touch-action:manipulation;white-space:nowrap;
}
.ci-open-btn:hover{
  background:rgba(57,255,143,.12);
  color:var(--green);
  border-color:rgba(57,255,143,.55);
  box-shadow:0 0 14px rgba(57,255,143,.25);
}

/* ── PANEL ── */
.panel-ov{position:fixed;inset:0;z-index:100;background:rgba(0,0,0,.92);backdrop-filter:blur(14px);display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .3s;}
.panel-ov.active{opacity:1;pointer-events:all;}
.panel{width:min(92vw,660px);max-height:82vh;background:linear-gradient(148deg,#131313,#0b0b0b);border:1px solid rgba(201,168,76,.17);border-radius:3px;overflow-y:auto;padding:42px 46px;position:relative;transform:translateY(22px)scale(.96);transition:transform .38s cubic-bezier(.34,1.56,.64,1);box-shadow:0 36px 90px rgba(0,0,0,.9);}
.panel-ov.active .panel{transform:translateY(0)scale(1);}
.panel-close{position:absolute;top:16px;right:20px;font-family:'Space Mono',monospace;font-size:.56rem;letter-spacing:.2em;color:var(--silver);cursor:pointer;background:none;border:none;transition:color .2s;}
.panel-close:hover{color:var(--gold);}
.panel-tag{font-family:'Space Mono',monospace;font-size:.46rem;letter-spacing:.28em;color:var(--gold);margin-bottom:7px;text-transform:uppercase;}
.panel-title{font-family:'Bebas Neue',sans-serif;font-size:clamp(1.9rem,4.5vw,3.2rem);letter-spacing:.07em;line-height:1;margin-bottom:20px;}
.panel-body{font-family:'Cormorant Garamond',serif;font-size:1.04rem;line-height:1.85;color:rgba(240,234,216,.7);}
.panel-body p{margin-bottom:13px;}
.panel-div{width:46px;height:1px;background:var(--gold);opacity:.28;margin:18px 0;}
.gg{display:grid;grid-template-columns:repeat(3,1fr);gap:6px;margin-top:16px;}
.gt{aspect-ratio:1;border-radius:2px;background:#121212;border:1px solid #1d1d1d;display:flex;align-items:center;justify-content:center;font-size:1.7rem;cursor:pointer;position:relative;transition:transform .28s,border-color .28s;}
.gt:hover{transform:scale(1.04);border-color:var(--gold);}
.gl{position:absolute;bottom:0;left:0;right:0;padding:6px;font-family:'Space Mono',monospace;font-size:.42rem;letter-spacing:.09em;color:var(--gold);background:linear-gradient(transparent,rgba(0,0,0,.88));opacity:0;transition:opacity .22s;}
.gt:hover .gl{opacity:1;}
.mg{display:grid;grid-template-columns:repeat(2,1fr);gap:13px;margin-top:16px;}
.mc{background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.05);border-radius:2px;padding:16px;transition:border-color .25s;}
.mc:hover{border-color:rgba(201,168,76,.26);}
.ma{width:42px;height:42px;border-radius:50%;background:linear-gradient(135deg,#202020,#121212);border:1px solid var(--gold);display:flex;align-items:center;justify-content:center;font-size:1.25rem;margin-bottom:8px;}
.mn{font-family:'Cormorant Garamond',serif;font-size:1rem;margin-bottom:2px;}
.mr{font-family:'Space Mono',monospace;font-size:.43rem;color:var(--gold);letter-spacing:.13em;}
.ei{display:flex;gap:16px;align-items:flex-start;padding:13px 0;border-bottom:1px solid rgba(255,255,255,.04);}
.ed{font-family:'Bebas Neue',sans-serif;font-size:1.4rem;color:var(--gold);line-height:1;min-width:44px;text-align:center;}
.em{font-family:'Space Mono',monospace;font-size:.42rem;color:var(--silver);letter-spacing:.13em;display:block;text-align:center;}
.eif h4{font-family:'Cormorant Garamond',serif;font-size:1rem;margin-bottom:3px;}
.eif p{font-family:'Space Mono',monospace;font-size:.47rem;color:var(--silver);letter-spacing:.08em;margin:0;}
.fg{margin-bottom:16px;}
.fl{display:block;font-family:'Space Mono',monospace;font-size:.47rem;letter-spacing:.19em;color:var(--gold);margin-bottom:6px;}
.fi{width:100%;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.07);border-radius:2px;padding:10px 14px;color:var(--white);font-family:'Cormorant Garamond',serif;font-size:.98rem;outline:none;transition:border-color .22s;}
.fi:focus{border-color:var(--gold);}.fi::placeholder{color:rgba(255,255,255,.16);}
.fb{width:100%;background:transparent;border:1px solid var(--gold);color:var(--gold);padding:12px;font-family:'Bebas Neue',sans-serif;font-size:1.1rem;letter-spacing:.28em;cursor:pointer;transition:all .26s;border-radius:2px;}
.fb:hover{background:var(--gold);color:var(--black);}
.panel::-webkit-scrollbar{width:3px;}.panel::-webkit-scrollbar-track{background:#090909;}.panel::-webkit-scrollbar-thumb{background:#282828;}
</style>
</head>
<body>

<!-- HORIZONTAL FILM STRIP -->
<div class="film-bg" aria-hidden="false" id="filmBg">
  <div class="film-strip-track" id="filmTrack"></div>
  <div class="film-fade-l"></div>
  <div class="film-fade-r"></div>
</div>

<!-- FILM FRAME POPUP -->
<div id="film-popup">
  <button class="fp-close" id="fpClose">[ ✕ ]</button>
  <div class="fp-tag" id="fpTag"></div>
  <div class="fp-title" id="fpTitle"></div>
  <div class="fp-body" id="fpBody"></div>
  <div class="fp-footer" id="fpFooter"></div>
</div>

<!-- INTRO -->
<div id="intro">
  <div class="intro-logo">Rangeen Pixels</div>
  <div class="intro-line"></div>
  <div class="intro-sub">◆ &nbsp; College Photography Club &nbsp; ◆</div>
</div>
<div id="flash"></div>

<!-- TICKER -->
<div class="ticker"><div class="ticker-track">
  <div class="tick"><b>◆</b> Rangeen Pixels PHOTOGRAPHY CLUB — EST. 2019</div>
  <div class="tick"><b>◆</b> MONTHLY PHOTOWALKS — EVERY FIRST SATURDAY</div>
  <div class="tick"><b>◆</b> ANNUAL EXHIBITION — SPRING 2026</div>
  <div class="tick"><b>◆</b> WORKSHOP: STUDIO LIGHTING — REGISTER NOW</div>
  <div class="tick"><b>◆</b> 47 ACTIVE MEMBERS THIS SEMESTER</div>
  <div class="tick"><b>◆</b> Rangeen Pixels PHOTOGRAPHY CLUB — EST. 2019</div>
  <div class="tick"><b>◆</b> MONTHLY PHOTOWALKS — EVERY FIRST SATURDAY</div>
  <div class="tick"><b>◆</b> ANNUAL EXHIBITION — SPRING 2026</div>
  <div class="tick"><b>◆</b> WORKSHOP: STUDIO LIGHTING — REGISTER NOW</div>
  <div class="tick"><b>◆</b> 47 ACTIVE MEMBERS THIS SEMESTER</div>
</div></div>

<!-- DARK VIGNETTE FOR EXPANDED STATE -->
<div id="lens-vignette"></div>

<!-- FIXED PORTAL — lens-asm teleports here when expanding -->
<div id="lens-portal"></div>

<!-- CLOSE BUTTON -->
<button id="lens-close">[ ESC ] CLOSE LENS</button>

<!-- SCENE -->
<div id="scene">
  <div class="cam-wrap" id="camWrap">
    <div class="cam-col" id="camCol">
      <div class="cam-body" id="camBody">

        <!-- TOP DECK -->
        <div class="cam-top-deck">
          <div class="cam-mode-dial" id="refreshBtn">
            <svg viewBox="0 0 24 24"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
          </div>
          <div class="cam-pentaprism"></div>
          <div class="cam-pentaprism-logo">Nikon</div>
          <div class="cam-top-lcd">
            <div class="cam-top-lcd-text">1/250<br>F5.6<br>ISO400</div>
          </div>
          <div class="cam-deck-right">
            <div class="led"></div>
            <div class="cam-rear-dial"></div>
            <div class="shutter-btn" id="shutterBtn"></div>
          </div>
        </div>

        <!-- MAIN BODY -->
        <div class="cam-main">
          <div class="cam-lens-section" id="lensSection">
            <div class="cam-brand-label">
              <div class="cam-brand">Rangeen Pixels</div>
              <div class="cam-spec">D7500 · AF-S · 18–140mm</div>
            </div>

            <!-- ★ THE LENS — will be teleported on expand ★ -->
            <div class="lens-asm" id="lensAsm">
              <div class="lens-glow"></div>
              <div class="ring r-outer"></div>
              <div class="ring r-mid"></div>
              <div class="ring r-inner"></div>
              <div id="lens-flash"></div>

              <div class="iris">
                <div class="glass" id="lensGlass">
                  <div class="blades" id="shutterBlades">
                    <div class="blade"></div><div class="blade"></div><div class="blade"></div><div class="blade"></div>
                    <div class="blade"></div><div class="blade"></div><div class="blade"></div><div class="blade"></div>
                  </div>
                  <div class="lens-int" id="lensInt">
                    <div class="lens-bg"></div>
                    <div class="flare fl1"></div><div class="flare fl2"></div>
                    <div class="fl3"></div><div class="fl4"></div>
                    <div class="dust"></div>
                    <div class="hud">
                      <div class="hud-h"></div><div class="hud-v"></div>
                      <div class="hud-c tl"></div><div class="hud-c tr"></div>
                      <div class="hud-c bl"></div><div class="hud-c br"></div>
                    </div>

                    <!-- ★ PIP-BOY CIRCULAR INFO DISPLAY (lives inside iris) ★ -->
                    <div id="circ-info">
                      <div class="ci-glass"></div>
                      <div class="ci-phosphor-glow"></div>
                      <div class="ci-scanlines"></div>
                      <div class="ci-vignette"></div>
                      <!-- arc progress ring -->
                      <div class="ci-arc-wrap">
                        <svg viewBox="0 0 100 100">
                          <circle class="ci-arc-track" cx="50" cy="50" r="48"/>
                          <circle class="ci-arc-fill" id="ciArcFill" cx="50" cy="50" r="48"/>
                        </svg>
                      </div>
                      <!-- tick marks -->
                      <div class="ci-ticks">
                        <svg viewBox="0 0 100 100" id="ciTicksSvg"></svg>
                      </div>
                      <div class="ci-content">
                        <!-- idle -->
                        <div class="ci-idle" id="ciIdle">
                          <div class="ci-ch-wrap">
                            <div class="ci-ch"></div>
                            <div class="ci-ring-pulse"></div>
                          </div>
                          <div class="ci-idle-lbl">Tap icon<br>to explore</div>
                        </div>
                        <!-- card -->
                        <div class="ci-card gone" id="ciCard">
                          <div class="ci-eyebrow" id="ciEyebrow"></div>
                          <div class="ci-icon-ring" id="ciIcon"></div>
                          <div class="ci-name" id="ciName"></div>
                          <div class="ci-desc" id="ciDesc"></div>
                          <div class="ci-stats" id="ciStats"></div>
                          <button class="ci-open-btn" id="ciOpenBtn">OPEN ◆</button>
                        </div>
                      </div>
                    </div>

                    <!-- iris deco -->
                    <svg class="iris-deco" viewBox="0 0 100 100" aria-hidden="true">
                      <circle cx="50" cy="50" r="48" fill="none" stroke="rgba(57,255,143,.3)" stroke-width=".6"/>
                      <circle cx="50" cy="50" r="38" fill="none" stroke="rgba(57,255,143,.12)" stroke-width=".3"/>
                    </svg>
                  </div>
                </div>
              </div>

              <!-- ★ NAV RADIAL — outside iris, spans full lens ★ -->
              <nav class="nav-radial" id="navRadial" aria-label="Navigation">
                <a class="nav-item" data-key="gallery"   href="#gallery"   aria-label="Gallery"><span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg></span><span class="nav-lbl">Gallery</span></a>
                <a class="nav-item" data-key="events"    href="#events"    aria-label="Events"><span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg></span><span class="nav-lbl">Events</span></a>
                <a class="nav-item" data-key="about"     href="#about"     aria-label="About"><span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><circle cx="12" cy="12" r="9"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg></span><span class="nav-lbl">About</span></a>
                <a class="nav-item" data-key="workshops" href="#workshops" aria-label="Workshops"><span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg></span><span class="nav-lbl">Workshop</span></a>
                <a class="nav-item" data-key="members"   href="#members"   aria-label="Members"><span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg></span><span class="nav-lbl">Members</span></a>
                <a class="nav-item" data-key="gear"      href="#gear"      aria-label="Gear"><span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l-.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg></span><span class="nav-lbl">Gear</span></a>
                <a class="nav-item" data-key="join"      href="#join"      aria-label="Join"><span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="8.5" cy="7" r="4"/><line x1="20" y1="8" x2="20" y2="14"/><line x1="23" y1="11" x2="17" y2="11"/></svg></span><span class="nav-lbl">Join</span></a>
                <a class="nav-item" data-key="awards"    href="#awards"    aria-label="Awards"><span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span><span class="nav-lbl">Awards</span></a>
                <!-- CENTER -->
                <a class="nav-item center" id="homeBtn" href="#" aria-label="Open lens view">
                  <span class="ico"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><circle cx="12" cy="12" r="9"/><circle cx="12" cy="12" r="3.5"/><line x1="12" y1="2.5" x2="12" y2="8.5"/><line x1="12" y1="15.5" x2="12" y2="21.5"/><line x1="2.5" y1="12" x2="8.5" y2="12"/><line x1="15.5" y1="12" x2="21.5" y2="12"/></svg></span>
                </a>
              </nav>

            </div><!-- /lens-asm -->
          </div><!-- /lens-section -->

          <!-- GRIP -->
          <div class="cam-grip">
            <div class="cam-lcd"><div class="cam-lcd-text">ISO<br>400</div></div>
            <div class="knob" id="navUp"><svg viewBox="0 0 24 24"><polyline points="18 15 12 9 6 15"/></svg></div>
            <div class="knob" id="navDn"><svg viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg></div>
            <div class="cam-grip-label">D7500</div>
          </div>
        </div>

        <div class="cam-bottom">
          <div class="cam-rd g">EXP — 036</div>
          <div class="cam-ap">ƒ/1.4</div>
          <div class="cam-rd s">ISO 400 · 1/125s</div>
        </div>
      </div><!-- /cam-body -->

      <div class="hint" id="hintText">— CLICK ◎ TO EXPAND · TAP ICONS TO EXPLORE —</div>
    </div><!-- /cam-col -->
  </div>
</div>

<!-- PANEL -->
<div class="panel-ov" id="panelOv">
  <div class="panel" id="panelEl">
    <button class="panel-close" id="panelClose">[ CLOSE ✕ ]</button>
    <div id="panelIn"></div>
  </div>
</div>

<script>
/* ══ HORIZONTAL FILM STRIP ══ */
(function(){
  const FRAMES = [
    {tag:'Gallery',       title:'Photo Gallery',    body:'A curated collection of member work — golden hour, darkroom prints, street documentary.', footer:'247 prints · 35mm & digital'},
    {tag:'Events',        title:'Upcoming Events',  body:'Monthly photowalks, film nights, portfolio critiques. Next walk: March 22 at the Botanic Garden, 5:30 PM.', footer:'12 events this term'},
    {tag:'About Us',      title:'Rangeen Pixels',   body:'Founded 2019 in a dorm room. Now running a darkroom, studio bay, and 30+ camera lending library.', footer:'Est. 2019 · 47 members'},
    {tag:'Workshops',     title:'Learn With Us',    body:'Film 101, Studio Lighting, Lightroom, Street Ethics, Composition Deep Dive — every semester, free for members.', footer:'5 active workshops'},
    {tag:'Members',       title:'Our Community',    body:'47 active photographers across all disciplines. A six-person committee leads the club through the year.', footer:'47 active · 6 on committee'},
    {tag:'Gear Library',  title:'Borrow a Camera',  body:'Canon R6, Hasselblad 500CM, Nikon FM2, Profoto B10 strobes. 48-hour loans, free for members in good standing.', footer:'31 bodies · 48hr max loan'},
    {tag:'Join',          title:'Become a Member',  body:'Open to all enrolled students. Annual dues €20 cover darkroom access, all gear loans, and every event.', footer:'€20/year · Open enrollment'},
    {tag:'Awards',        title:'Honours',          body:'NPSA Photo of the Year, National Student Award, Best University Club 2024. Our work speaks for itself.', footer:'6 trophies · National level'},
  ];

  const track = document.getElementById('filmTrack');
  const n = FRAMES.length;
  // build 3 sets for seamless loop
  let html = '';
  for(let rep=0;rep<3;rep++){
    for(let i=0;i<n;i++){
      const f = FRAMES[i];
      const globalIdx = rep*n + i;
      html += `<div class="vfr" data-idx="${i}" role="button" tabindex="0" aria-label="Open ${f.title}">
        <div class="vfr-img"></div>
        <div class="vfr-num">${String(i+1).padStart(2,'0')}</div>
        <div class="vfr-label">${f.tag}</div>
      </div>`;
    }
  }
  track.innerHTML = html;

  // Set animation
  track.style.animation = 'filmLeft 45s linear infinite';

  // Popup logic
  const popup = document.getElementById('film-popup');
  const fpClose = document.getElementById('fpClose');
  let activeFrame = null;

  function showPopup(frameEl, idx){
    const f = FRAMES[idx % n];
    document.getElementById('fpTag').textContent = f.tag;
    document.getElementById('fpTitle').textContent = f.title;
    document.getElementById('fpBody').textContent = f.body;
    document.getElementById('fpFooter').textContent = f.footer;

    // Position popup near the frame but ensure it stays on screen
    const rect = frameEl.getBoundingClientRect();
    const pw = 360, ph = 180;
    let left = rect.left + rect.width/2 - pw/2;
    let top = rect.top - ph - 14;
    if(top < 10) top = rect.bottom + 14;
    if(left < 10) left = 10;
    if(left + pw > window.innerWidth - 10) left = window.innerWidth - pw - 10;

    popup.style.left = left + 'px';
    popup.style.top = top + 'px';
    popup.style.width = pw + 'px';
    popup.classList.add('show');
    activeFrame = frameEl;

    // Pause strip while popup open
    track.style.animationPlayState = 'paused';
  }

  function hidePopup(){
    popup.classList.remove('show');
    track.style.animationPlayState = 'running';
    activeFrame = null;
  }

  fpClose.addEventListener('click', e => { e.stopPropagation(); hidePopup(); });
  popup.addEventListener('click', e => e.stopPropagation());

  document.addEventListener('click', e => {
    const fr = e.target.closest('.vfr');
    if(fr){
      const idx = parseInt(fr.dataset.idx, 10);
      if(activeFrame === fr && popup.classList.contains('show')){
        hidePopup();
      } else {
        showPopup(fr, idx);
      }
    } else if(!popup.contains(e.target)){
      hidePopup();
    }
  });

  // Keyboard support
  track.addEventListener('keydown', e => {
    if(e.key === 'Enter' || e.key === ' '){
      const fr = e.target.closest('.vfr');
      if(fr){ e.preventDefault(); fr.click(); }
    }
  });
})();

/* ══ DATA ══ */
const DATA={
  gallery:  {eyebrow:'Visual Archive',name:'GALLERY',  desc:'Golden hour, darkroom prints & raw street documentary — member work from across the globe.',stats:[{v:'247',k:'Prints'},{v:'35mm',k:'Format'},{v:'f/2.8',k:'Avg'}],prog:87,
    svg:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>'},
  events:   {eyebrow:'Schedule',name:'EVENTS',   desc:'Monthly photowalks, darkroom open nights, portfolio critiques, and Spring Exhibition.',stats:[{v:'12',k:'This term'},{v:'MAR 22',k:'Next walk'},{v:'APR 28',k:'Exhibition'}],prog:58,
    svg:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>'},
  about:    {eyebrow:'Club profile',name:'ABOUT',    desc:'Founded 2019. Full darkroom, studio bay, 30-body lending library — from point-and-shoot to Hasselblad.',stats:[{v:'47',k:'Members'},{v:'2019',k:'Founded'},{v:'1',k:'Darkroom'}],prog:94,
    svg:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round"><circle cx="12" cy="12" r="9"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>'},
  workshops:{eyebrow:'Training',name:'WORKSHOPS',desc:'Film 101, studio lighting, Lightroom, street ethics, composition — every semester.',stats:[{v:'5',k:'Active'},{v:'8hr',k:'Per session'},{v:'Free',k:'Members'}],prog:38,
    svg:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>'},
  members:  {eyebrow:'Personnel',name:'MEMBERS',  desc:'Photographers across all disciplines. A committee of six leads the club.',stats:[{v:'47',k:'Active'},{v:'6',k:'Committee'},{v:'3yr',k:'Avg tenure'}],prog:78,
    svg:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>'},
  gear:     {eyebrow:'Equipment',name:'GEAR',     desc:'Canon R6, Hasselblad 500CM, Nikon FM2, Profoto B10, Durst enlargers.',stats:[{v:'31',k:'Bodies'},{v:'48hr',k:'Max loan'},{v:'Free',k:'Members'}],prog:62,
    svg:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l-.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>'},
  join:     {eyebrow:'Membership',name:'JOIN US',   desc:'Open to all enrolled students. Annual dues €20 covers darkroom, gear & all events.',stats:[{v:'€20',k:'Per year'},{v:'Open',k:'Status'},{v:'∞',k:'Access'}],prog:100,
    svg:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="8.5" cy="7" r="4"/><line x1="20" y1="8" x2="20" y2="14"/><line x1="23" y1="11" x2="17" y2="11"/></svg>'},
  awards:   {eyebrow:'Recognition',name:'AWARDS',   desc:'NPSA Photo of Year, National Student Award, Best University Club 2024.',stats:[{v:'6',k:'Trophies'},{v:'2025',k:'Last win'},{v:'Natl.',k:'Level'}],prog:93,
    svg:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>'}
};
const PANELS={
  gallery:  {tag:'Work',title:'Our Gallery',html:`<div class="panel-body"><p>A curated selection from our members' finest work — from campus corridors to distant horizons.</p></div><div class="gg">${[['🌆','Golden Hour'],['🌿','Botanica'],['👤','Portraits'],['🌊','Seascape'],['🏙','Urban Life'],['🎭','Street'],['🌌','Astrophoto'],['🍂','Seasons'],['🔬','Macro']].map(([e,l])=>`<div class="gt">${e}<div class="gl">${l}</div></div>`).join('')}</div>`},
  events:   {tag:'Schedule',title:'Upcoming Events',html:`<div class="panel-body"><p>Mark your calendars — something is always happening in the Rangeen Pixels world.</p></div>${[['22','MAR','Golden Hour Photowalk','Campus Botanic Garden · 5:30 PM'],['01','APR','Film Development Workshop','Darkroom, Arts Block B · 2:00 PM'],['14','APR','Street Photography Challenge','City Centre · All Day'],['28','APR','Annual Spring Exhibition','Gallery Hall · Opening Night'],['05','MAY','Portrait Session — Open Studio','Studio 3, Arts Complex · 3:00 PM']].map(([d,m,t,i])=>`<div class="ei"><div class="ed">${d}<span class="em">${m}</span></div><div class="eif"><h4>${t}</h4><p>${i}</p></div></div>`).join('')}`},
  about:    {tag:'Our Story',title:'About Rangeen Pixels',html:`<div class="panel-body"><p>Rangeen Pixels was born in a cramped dorm room in 2019, when students discovered a shared obsession with seeing the world through glass.</p><p>Today we run a fully-equipped darkroom, studio lighting bay, and a lending library of 30+ cameras — from point-and-shoots to a Hasselblad 500CM.</p><div class="panel-div"></div><p><em>Every person has a unique way of seeing the world. Photography is how you share it.</em></p></div>`},
  workshops:{tag:'Learn',title:'Workshops',html:`<div class="panel-body"><p>From beginner introductions to advanced masterclasses — every semester.</p></div>${[['◉','Film Photography 101','Loading, developing, printing in the darkroom.'],['◈','Studio Lighting Masterclass','Three-point setups, softboxes, colour gels.'],['◆','Lightroom & Editing','Culling, tonal grading, building your palette.'],['◇','Street Photography Ethics','Navigate consent, find your documentary style.'],['✦','Composition Deep Dive','Rules of thirds, leading lines, negative space.']].map(([ic,t,d])=>`<div class="ei"><div class="ed" style="font-size:1.4rem;min-width:36px;text-align:center">${ic}</div><div class="eif"><h4>${t}</h4><p>${d}</p></div></div>`).join('')}`},
  members:  {tag:'People',title:'The Team',html:`<div class="panel-body"><p>The people behind the lens.</p></div><div class="mg">${[['📷','Maya Chen','President'],['🎞','Arjun Patel','Vice President'],['🌟','Sofia Torres','Events Lead'],["🔲","James O'Brien",'Darkroom Manager'],['🎨','Priya Singh','Gallery Curator'],['⚙','Lucas Kim','Gear & Equipment']].map(([a,n,r])=>`<div class="mc"><div class="ma">${a}</div><div class="mn">${n}</div><div class="mr">${r}</div></div>`).join('')}</div>`},
  gear:     {tag:'Equipment',title:'Lending Library',html:`<div class="panel-body"><p>Members in good standing may borrow gear for 48 hours.</p></div>${[['📷','Canon EOS R6 Mark II','Full-frame mirrorless · Available'],['📷','Hasselblad 500CM','Medium format film · Book ahead'],['📷','Nikon FM2','35mm SLR · 3 units available'],['💡','Profoto B10 Kit','2-head location strobe · Available'],['🎞','Darkroom Enlargers','Durst M605 × 4 · Booking required'],['🔭','Telephoto 70-200mm f/2.8','Canon L-series · Available']].map(([ic,n,s])=>`<div class="ei"><div class="ed" style="font-size:1.4rem;min-width:36px">${ic}</div><div class="eif"><h4>${n}</h4><p>${s}</p></div></div>`).join('')}`},
  join:     {tag:'Membership',title:'Join Us',html:`<div class="panel-body"><p>Open to all enrolled students. Annual dues €20.</p></div><div class="panel-div"></div><div class="fg"><label class="fl">Full Name</label><input class="fi" type="text" placeholder="Your name"></div><div class="fg"><label class="fl">Student Email</label><input class="fi" type="email" placeholder="you@university.edu"></div><div class="fg"><label class="fl">Experience Level</label><select class="fi" style="background:#0b0b0b"><option>Select one…</option><option>Complete beginner</option><option>Hobbyist</option><option>Intermediate</option><option>Advanced</option></select></div><div class="fg"><label class="fl">What draws you to photography?</label><textarea class="fi" rows="3" placeholder="Tell us about yourself…" style="resize:vertical"></textarea></div><button class="fb" onclick="alert('Application received! 📷')">SUBMIT APPLICATION</button>`},
  awards:   {tag:'Recognition',title:'Awards & Honours',html:`<div class="panel-body"><p>Our members have won recognition nationally and internationally.</p></div>${[['◆','2025 NPSA Photo of the Year','Maya Chen — "Morning Market, Hanoi"'],['◆','National Student Photography Award','Arjun Patel — Documentary Category'],['◆','Best University Photography Club','Intercollegiate Arts Council, 2024'],['◆','Regional Press Photography Prize','Sofia Torres — "The March"'],['◆','Graduate Showcase — Dublin Gallery','Five members selected, Spring 2024'],["◆","Darkroom Print Excellence Award","James O'Brien — Alternative Process"]].map(([ic,t,d])=>`<div class="ei"><div class="ed" style="font-size:1rem;color:var(--gold);min-width:24px">${ic}</div><div class="eif"><h4>${t}</h4><p>${d}</p></div></div>`).join('')}`}
};

/* ══ TICK MARKS for circular display ══ */
(function(){
  const svg=document.getElementById('ciTicksSvg');
  const n=60,cx=50,cy=50,r=47;
  let s='';
  for(let i=0;i<n;i++){
    const a=i/n*2*Math.PI-Math.PI/2;
    const long=i%5===0;
    const len=long?3.5:1.8;
    const op=long?.35:.15;
    const x1=cx+(r)*Math.cos(a),y1=cy+(r)*Math.sin(a);
    const x2=cx+(r-len)*Math.cos(a),y2=cy+(r-len)*Math.sin(a);
    s+=`<line x1="${x1.toFixed(2)}" y1="${y1.toFixed(2)}" x2="${x2.toFixed(2)}" y2="${y2.toFixed(2)}" stroke="rgba(57,255,143,${op})" stroke-width="${long?0.8:0.5}"/>`;
  }
  svg.innerHTML=s;
})();

/* ══ NAV BUILD ══ */
const navRadialEl=document.getElementById('navRadial');
let isExpanded=false;

function buildNav(){
  const ring=[...navRadialEl.querySelectorAll('.nav-item:not(.center)')];
  const home=navRadialEl.querySelector('.nav-item.center');
  const rect=navRadialEl.getBoundingClientRect();
  const W=rect.width, H=rect.height;
  if(W<10) return;
  const cx=W/2, cy=H/2;

  if(isExpanded){
    // r-inner band geometry:
    //   r-inner outer edge: inset 17% → radius = 33% of W
    //   iris inner edge:    inset 25% → radius = 25% of W
    //   Band center: 29% radius, icon size 7% → spans 25.5%–32.5% ✓ fits cleanly
    const sz = Math.max(44, Math.min(70, W * 0.07));
    const R  = W * 0.29;

    let orb=navRadialEl.querySelector('.orbit-ring');
    if(!orb){orb=document.createElement('div');orb.className='orbit-ring';navRadialEl.prepend(orb);}
    const od=R*2;
    orb.style.cssText=`width:${od}px;height:${od}px;top:${cy-od/2}px;left:${cx-od/2}px;border-color:rgba(57,255,143,.1);opacity:1;`;

    ring.forEach((el,i)=>{
      const a = i/ring.length * 2*Math.PI - Math.PI/2;
      el.style.left   = (cx + R*Math.cos(a) - sz/2) + 'px';
      el.style.top    = (cy + R*Math.sin(a) - sz/2) + 'px';
      el.style.width  = sz + 'px';
      el.style.height = sz + 'px';
      el.style.opacity = '';
      el.style.transform = '';
      el.style.pointerEvents = '';
    });

    // Hide center — pip-boy owns the center
    if(home){
      home.style.cssText = 'left:-9999px;top:-9999px;width:1px;height:1px;opacity:0;pointer-events:none;animation:none;';
    }

  } else {
    const sz = Math.max(30, Math.min(50, W * 0.16));
    const orb=navRadialEl.querySelector('.orbit-ring');
    if(orb) orb.style.opacity='0';
    ring.forEach(el=>{
      el.style.left = '-9999px';
      el.style.top  = '-9999px';
      el.style.opacity = '0';
      el.style.pointerEvents = 'none';
    });
    if(home){
      home.style.cssText=`left:${cx-sz/2}px;top:${cy-sz/2}px;width:${sz}px;height:${sz}px;opacity:1;pointer-events:all;`;
    }
  }
}
let _roActive = true;
const _ro = new ResizeObserver(()=>{ if(_roActive) buildNav(); });
_ro.observe(navRadialEl);

/* ══ LENS EXPAND / COLLAPSE ══ */
const lensAsm   =document.getElementById('lensAsm');
const lensSection=document.getElementById('lensSection');
const portal    =document.getElementById('lens-portal');
const vignette  =document.getElementById('lens-vignette');
const closePill =document.getElementById('lens-close');
const camCol    =document.getElementById('camCol');
const circInfo  =document.getElementById('circ-info');
const lensFlashEl=document.getElementById('lens-flash');

let _origLensRect=null;

function expandLens(){
  if(isExpanded) return;
  isExpanded=true;

  // Camera flash
  lensFlashEl.classList.remove('blink'); void lensFlashEl.offsetWidth; lensFlashEl.classList.add('blink');

  // Capture current lens bounding rect (before any DOM move)
  const rect=lensAsm.getBoundingClientRect();
  _origLensRect=rect; // save for collapse

  // Size the portal to match the lens exactly (instant, no transition yet)
  Object.assign(portal.style,{
    transition:'none',
    left:rect.left+'px', top:rect.top+'px',
    width:rect.width+'px', height:rect.height+'px',
  });
  // Move lens into portal
  portal.appendChild(lensAsm);
  void portal.offsetWidth; // reflow

  // Now enable transitions and animate to fullscreen
  const VW=window.innerWidth, VH=window.innerHeight;
  const EL=Math.min(VW*.96, VH*.95);
  const tl=(VW-EL)/2, tt=(VH-EL)/2;
  portal.style.transition='left .85s cubic-bezier(.16,1,.3,1),top .85s cubic-bezier(.16,1,.3,1),width .85s cubic-bezier(.16,1,.3,1),height .85s cubic-bezier(.16,1,.3,1)';
  portal.style.left=tl+'px';
  portal.style.top=tt+'px';
  portal.style.width=EL+'px';
  portal.style.height=EL+'px';
  portal.classList.add('is-expanded');
  _roActive = false; // pause observer during animation
  lensAsm.classList.add('lens-expanded');

  vignette.classList.add('show');
  closePill.classList.add('show');
  document.getElementById('shutterBtn').classList.add('active-btn');
  camCol.style.transform='translateX(-55px) scale(.97)';
  camCol.style.opacity='0';
  setTimeout(()=>{camCol.style.visibility='hidden';},500);

  setTimeout(()=>{
    _roActive = true;
    buildNav();
    requestAnimationFrame(()=>{
      buildNav();
      circInfo.classList.add('show');
      document.getElementById('hintText').textContent='— HOVER AN ICON TO EXPLORE · ESC TO CLOSE —';
      const items=[...navRadialEl.querySelectorAll('.nav-item:not(.center)')];
      items.forEach((el,i)=>setTimeout(()=>el.classList.add('show'), i*60+30));
    });
  }, 920);
}

function collapseLens(){
  if(!isExpanded) return;

  // Hide info panel and reset state
  circInfo.classList.remove('show');
  clearInfo();
  document.getElementById('shutterBtn').classList.remove('active-btn');

  // Get the original slot position using saved rect from expand
  let rect=_origLensRect;
  if(!rect){
    // Fallback: place a placeholder to find where the lens would go
    const Lpx=parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--L'))||280;
    const ph=document.createElement('div');
    ph.style.cssText=`width:${Lpx}px;height:${Lpx}px;visibility:hidden;flex-shrink:0;`;
    lensSection.appendChild(ph);
    rect=ph.getBoundingClientRect();
    lensSection.removeChild(ph);
  }

  // Animate portal back to original position/size
  portal.style.transition='left .7s cubic-bezier(.4,0,.2,1),top .7s cubic-bezier(.4,0,.2,1),width .7s cubic-bezier(.4,0,.2,1),height .7s cubic-bezier(.4,0,.2,1)';
  portal.style.left=rect.left+'px';
  portal.style.top=rect.top+'px';
  portal.style.width=rect.width+'px';
  portal.style.height=rect.height+'px';

  // Camera slide back in
  camCol.style.visibility='';
  camCol.style.transform='';
  camCol.style.opacity='1';
  vignette.classList.remove('show');
  closePill.classList.remove('show');
  portal.classList.remove('is-expanded');
  lensAsm.classList.remove('lens-expanded');

  // After animation: move lens back to original parent
  setTimeout(()=>{
    isExpanded=false;
    _origLensRect=null;
    // Hide ring icons, remove their show class
    navRadialEl.querySelectorAll('.nav-item:not(.center)').forEach(el=>el.classList.remove('show'));
    // Reset lens size
    lensAsm.style.width='';
    lensAsm.style.height='';
    lensSection.insertBefore(lensAsm, lensSection.querySelector('.cam-brand-label')?.nextSibling || null);
    // Clean up portal
    portal.style.cssText='';
    buildNav();
    document.getElementById('hintText').textContent='— CLICK ◎ TO EXPAND · TAP ICONS TO EXPLORE —';
  }, 720);
}

/* ══ CIRCULAR INFO DISPLAY ══ */
const CIRC=314.16; // 2π×50 (for r=50 in viewBox 100)
let currentKey=null;

function showInfo(key){
  const d=DATA[key]; if(!d) return;
  currentKey=key;

  // Highlight selected icon
  navRadialEl.querySelectorAll('.nav-item').forEach(el=>{
    el.classList.toggle('selected', el.dataset.key===key);
  });

  // Populate
  document.getElementById('ciEyebrow').textContent=d.eyebrow;
  document.getElementById('ciIcon').innerHTML=d.svg;
  const nameEl=document.getElementById('ciName');
  nameEl.textContent=d.name;
  // Phosphor flicker on name change
  nameEl.classList.remove('flicker');
  void nameEl.offsetWidth;
  nameEl.classList.add('flicker');
  document.getElementById('ciDesc').textContent=d.desc;
  // Stats with dividers
  document.getElementById('ciStats').innerHTML=d.stats.map((s,i)=>
    (i>0?'<div class="ci-stat-divider"></div>':'') +
    `<div class="ci-stat"><div class="v">${s.v}</div><div class="k">${s.k}</div></div>`
  ).join('');

  // Arc progress (circ of r=48 in 100 viewBox ≈ 301.6)
  const arc=301.6, fill=document.getElementById('ciArcFill');
  fill.style.strokeDashoffset=arc;
  requestAnimationFrame(()=>requestAnimationFrame(()=>{
    fill.style.strokeDashoffset=(arc*(1-d.prog/100)).toFixed(2);
  }));

  // Swap idle ↔ card
  document.getElementById('ciIdle').classList.add('gone');
  document.getElementById('ciCard').classList.remove('gone');
}

function clearInfo(){
  currentKey=null;
  document.getElementById('ciIdle').classList.remove('gone');
  document.getElementById('ciCard').classList.add('gone');
  document.getElementById('ciArcFill').style.strokeDashoffset='301.6';
  navRadialEl.querySelectorAll('.nav-item').forEach(el=>el.classList.remove('selected'));
}
/* ── Open panel from circ-info ── */
document.getElementById('ciOpenBtn').addEventListener('click',()=>{
  if(currentKey){ collapseLens(); setTimeout(()=>openPanel(currentKey),500); }
});

/* ══ NAV ITEM EVENTS ══ */
navRadialEl.querySelectorAll('.nav-item:not(.center)').forEach(el=>{
  // Click — when expanded: show info; when collapsed: expand first
  el.addEventListener('click',e=>{
    e.preventDefault();
    const key=el.dataset.key;
    if(isExpanded){
      showInfo(key);
    } else {
      expandLens();
      setTimeout(()=>showInfo(key),750);
    }
  });
  // Hover preview when already expanded
  el.addEventListener('mouseenter',()=>{
    if(isExpanded && el.dataset.key) showInfo(el.dataset.key);
  });
  // Keyboard
  el.addEventListener('keydown',e=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();el.click();}});
});

/* Center button = expand/collapse */
document.getElementById('homeBtn').addEventListener('click',e=>{
  e.preventDefault();
  isExpanded ? collapseLens() : expandLens();
});
document.getElementById('shutterBtn').addEventListener('click',()=>{
  isExpanded ? collapseLens() : expandLens();
});

/* ══ GRIP KNOBS ══ */
const KEYS=Object.keys(DATA);
let navIdx=0;
function navCycle(dir){
  if(!isExpanded){
    expandLens();
    setTimeout(()=>{navIdx=(navIdx+dir+KEYS.length)%KEYS.length;showInfo(KEYS[navIdx]);},800);
    return;
  }
  navIdx=(navIdx+dir+KEYS.length)%KEYS.length;
  showInfo(KEYS[navIdx]);
}
document.getElementById('navUp').addEventListener('click',()=>{
  navCycle(-1);
  const k=document.getElementById('navUp'); k.classList.remove('flash'); void k.offsetWidth; k.classList.add('flash'); setTimeout(()=>k.classList.remove('flash'),300);
});
document.getElementById('navDn').addEventListener('click',()=>{
  navCycle(1);
  const k=document.getElementById('navDn'); k.classList.remove('flash'); void k.offsetWidth; k.classList.add('flash'); setTimeout(()=>k.classList.remove('flash'),300);
});

/* ══ REFRESH ══ */
document.getElementById('refreshBtn').addEventListener('click',()=>{
  const b=document.getElementById('refreshBtn');
  b.classList.remove('spin'); void b.offsetWidth; b.classList.add('spin');
  lensFlashEl.classList.remove('blink'); void lensFlashEl.offsetWidth; lensFlashEl.classList.add('blink');
  setTimeout(()=>location.reload(),400);
});

/* ══ CLOSE / ESC ══ */
vignette.addEventListener('click',collapseLens);
closePill.addEventListener('click',collapseLens);
document.addEventListener('keydown',e=>{
  if(e.key==='Escape'){if(isExpanded)collapseLens();else closePanel();}
});

// hash-jump prevention is already handled inside the nav-item click handlers above

/* ══ PANELS ══ */
function openPanel(key){
  const p=PANELS[key]; if(!p) return;
  document.getElementById('panelIn').innerHTML=`<div class="panel-tag">◆ ${p.tag}</div><div class="panel-title">${p.title}</div>${p.html}`;
  document.getElementById('panelOv').classList.add('active');
  document.getElementById('panelEl').scrollTop=0;
}
function closePanel(){
  document.getElementById('panelOv').classList.remove('active');
  history.replaceState(null,'',location.pathname+location.search);
}
document.getElementById('panelClose').addEventListener('click',closePanel);
document.getElementById('panelOv').addEventListener('click',e=>{if(e.target===document.getElementById('panelOv'))closePanel();});
window.addEventListener('hashchange',()=>{const k=location.hash.slice(1);k&&PANELS[k]?openPanel(k):document.getElementById('panelOv').classList.remove('active');});

/* ══ BOOT ══ */
const HOLD=2200, FDUR=950;
setTimeout(()=>{document.getElementById('intro').classList.add('out');document.getElementById('flash').classList.add('fire');}, HOLD);
setTimeout(()=>{
  document.getElementById('scene').classList.add('show');
  document.getElementById('shutterBlades').classList.add('open');
  document.getElementById('lensGlass').classList.add('open');
}, HOLD+FDUR*.5);
setTimeout(()=>{
  buildNav();
  document.getElementById('lensInt').classList.add('visible');
  // Don't auto-show ring items on load — only center button visible initially
  const h=location.hash.slice(1); if(h&&PANELS[h]) openPanel(h);
}, HOLD+FDUR+200);
</script>
</body>
</html>
